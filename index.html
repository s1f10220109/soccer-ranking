<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>サッカーランキング管理システム</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>⚽ サッカーランキング管理システム</h1>
            <p>FIFAランキング形式で試合結果を記録</p>
        </header>

        <div class="main-content">
            <!-- ログインセクション -->
            <section class="section" id="loginSection">
                <h2>🔑 ログイン</h2>
                <p>データをクラウドに保存し、他のデバイスと同期するにはログインしてください。</p>
                <button onclick="loginWithGoogle()" class="btn btn-primary">
                    <svg width="18" height="18" style="vertical-align: middle; margin-right: 8px;">
                        <image href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%234285F4' d='M45.12 24.5c0-1.56-.14-3.06-.4-4.5H24v8.51h11.84c-.51 2.75-2.06 5.08-4.39 6.64v5.52h7.11c4.16-3.83 6.56-9.47 6.56-16.17z'/%3E%3Cpath fill='%2334A853' d='M24 46c5.94 0 10.92-1.97 14.56-5.33l-7.11-5.52c-1.97 1.32-4.49 2.1-7.45 2.1-5.73 0-10.58-3.87-12.31-9.07H4.34v5.7C7.96 41.07 15.4 46 24 46z'/%3E%3Cpath fill='%23FBBC05' d='M11.69 28.18C11.25 26.86 11 25.45 11 24s.25-2.86.69-4.18v-5.7H4.34C2.85 17.09 2 20.45 2 24c0 3.55.85 6.91 2.34 9.88l7.35-5.7z'/%3E%3Cpath fill='%23EA4335' d='M24 10.75c3.23 0 6.13 1.11 8.41 3.29l6.31-6.31C34.91 4.18 29.93 2 24 2 15.4 2 7.96 6.93 4.34 14.12l7.35 5.7c1.73-5.2 6.58-9.07 12.31-9.07z'/%3E%3C/svg%3E" width="18" height="18"/>
                    </svg>
                    Googleでログイン
                </button>
                <p style="margin-top: 10px; color: #666; font-size: 0.9em;">※ ログインせずに使うこともできます（ローカル保存）</p>
            </section>

            <!-- ユーザー情報表示 -->
            <section class="section" id="userInfo" style="display: none;">
                <div class="user-info-content">
                    <div class="user-details">
                        <h3>👤 <span id="userName"></span></h3>
                        <p><span id="userEmail"></span></p>
                    </div>
                    <button onclick="logout()" class="btn btn-danger">ログアウト</button>
                </div>
            </section>

            <!-- 共有機能 -->
            <section class="section" id="shareSection" style="display: none;">
                <h2>🤝 共同編集</h2>
                <p>他のGoogleアカウントとこのランキングを共有して、一緒に編集できます。</p>
                
                <div class="share-controls">
                    <button onclick="generateShareLink()" class="btn btn-primary">共有リンクを生成</button>
                    <div id="shareLinkDisplay" style="display: none; margin-top: 15px;">
                        <label>共有リンク:</label>
                        <div class="share-link-box">
                            <input type="text" id="shareLinkInput" readonly>
                            <button onclick="copyShareLink()" class="btn btn-secondary">コピー</button>
                        </div>
                        <p style="font-size: 0.9em; color: #666; margin-top: 5px;">
                            このリンクを友達に送ると、Googleアカウントでログインして一緒に編集できます
                        </p>
                    </div>
                </div>

                <div id="sharedUsersList" style="display: none; margin-top: 20px;">
                    <h3>共有中のユーザー</h3>
                    <div id="sharedUsersContent"></div>
                </div>
            </section>
            <!-- チーム登録セクション -->
            <section class="section">
                <h2>チーム登録</h2>
                <div class="form-group">
                    <input type="text" id="teamName" placeholder="チーム名を入力">
                    <button onclick="addTeam()" class="btn btn-primary">チームを追加</button>
                </div>
            </section>

            <!-- 試合記録セクション -->
            <section class="section">
                <h2>試合記録</h2>
                <div class="match-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label>ホームチーム</label>
                            <select id="homeTeam">
                                <option value="">選択してください</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>スコア</label>
                            <div class="score-inputs">
                                <input type="number" id="homeScore" min="0" value="0">
                                <span>-</span>
                                <input type="number" id="awayScore" min="0" value="0">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>アウェイチーム</label>
                            <select id="awayTeam">
                                <option value="">選択してください</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>試合タイプ</label>
                            <select id="matchType">
                                <option value="friendly">親善試合 (x1.0)</option>
                                <option value="qualifier">予選 (x2.5)</option>
                                <option value="continental">大陸選手権 (x3.0)</option>
                                <option value="worldcup">ワールドカップ (x4.0)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>試合日</label>
                            <input type="date" id="matchDate">
                        </div>
                    </div>
                    <button onclick="recordMatch()" class="btn btn-success">試合を記録</button>
                </div>
            </section>

            <!-- ランキング表示 -->
            <section class="section">
                <h2>現在のランキング</h2>
                <div class="ranking-controls">
                    <button onclick="exportData()" class="btn btn-secondary">データをエクスポート</button>
                    <button onclick="clearAllData()" class="btn btn-danger">全データをクリア</button>
                </div>
                <div id="rankingTable"></div>
            </section>

            <!-- 試合履歴 -->
            <section class="section">
                <h2>試合履歴</h2>
                <div id="matchHistory"></div>
            </section>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script src="app.js"></script>
</body>
</html>
